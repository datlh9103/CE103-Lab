ORG 0000H
	MOV TMOD, #20H
	MOV TH1, #0FDH
	MOV SCON, #50H
	SETB TR1
	MOV R0, #-1
	MOV R1, #-1
MAIN:
	JMP QUETPHIM
	JMP MAIN
CIN:
	CJNE R0, #-1, CIN1
	MOV R0, A
	RET
	CIN1:
	MOV R1, A
	RET
HIENTHI:
	MOV SBUF, R2
	JNB TI, $
	CLR TI
	CALL DELAY
	RET
QUETPHIM:
	MOV P2, # 11111110B
	JNB P2.4, SO_7
	JNB P2.5, SO_8
	JNB P2.6, SO_9
	JNB P2.7, CHIA
	
	MOV P2, # 11111101B
	JNB P2.4, SO_4
	JNB P2.5, SO_5
	JNB P2.6, SO_6
	JNB P2.7, NHAN
	
	MOV P2, # 11111011B
	JNB P2.4, SO_1
	JNB P2.5, SO_2
	JNB P2.6, SO_3
	JNB P2.7, TRU
	
	MOV P2, # 11110111B
	JNB P2.4, RESET
	JNB P2.5, SO_0
	JNB P2.6, BANG
	JNB P2.7, CONG
	JMP MAIN
TACHSO:
	MOV B, #10
	DIV AB
	ADD A ,#30H
	MOV SBUF, A
	JNB TI, $
	CLR TI
	MOV A, B
	ADD A, #30H
	MOV SBUF, A
	JNB TI, $
	CLR TI
	RET
SO_0:
	JMP SO_01
SO_1:
	JMP SO_11
SO_2:
	JMP SO_21
SO_3:
	JMP SO_31
SO_4:
	JMP SO_41
SO_5:
	JMP SO_51
SO_6:
	JMP SO_61
SO_7:
	JMP SO_71
SO_8:
	MOV A, #8
	CALL CIN
	JMP SO_81
SO_9:
	JMP SO_91
CONG:
	JMP CONG1
TRU:
	JMP TRU1
NHAN:
	JMP NHAN1
CHIA:
	JMP CHIA1
BANG:
	JMP BANG1
RESET:
	JMP RESET1
SO_01:
	MOV A, #0
	CALL CIN
	MOV R2, #'0'
	CALL HIENTHI
	JMP MAIN
SO_11:
	MOV A, #1
	CALL CIN
	MOV R2, #'1'
	CALL HIENTHI
	JMP MAIN
SO_21:
	MOV A, #2
	CALL CIN
	MOV R2, #'2'
	CALL HIENTHI
	JMP MAIN
SO_31:
	MOV A, #3
	CALL CIN
	MOV R2, #'3'
	CALL HIENTHI
	JMP MAIN
SO_41:
	MOV A, #4
	CALL CIN
	MOV R2, #'4'
	CALL HIENTHI
	JMP MAIN
SO_51:
	MOV A, #5
	CALL CIN
	MOV R2, #'5'
	CALL HIENTHI
	JMP MAIN
SO_61:
	MOV A, #6
	CALL CIN
	MOV R2, #'6'
	CALL HIENTHI
	JMP MAIN
SO_71:
	MOV A, #7
	CALL CIN
	MOV R2, #'7'
	CALL HIENTHI
	JMP MAIN
SO_81:
	MOV A, #8
	CALL CIN
	MOV R2, #'8'
	CALL HIENTHI
	JMP MAIN
SO_91:
	MOV A, #9
	CALL CIN
	MOV R2, #'9'
	CALL HIENTHI
	JMP MAIN
CONG1:
	MOV R3, #'+'
	MOV R2, #'+'
	CALL HIENTHI
	JMP MAIN
TRU1:
	MOV R3, #'-'
	MOV R2, #'-'
	CALL HIENTHI
	JMP MAIN
NHAN1:
	MOV R3, #'*'
	MOV R2, #'*'
	CALL HIENTHI
	JMP MAIN
CHIA1:
	MOV R3, #'/'
	MOV R2, #'/'
	CALL HIENTHI
	JMP MAIN
BANG1:
	MOV R2, #'='
	CALL HIENTHI
	CALL RESULT
RESULT:
	MOV A, R0
	CJNE R3, #'+', SUB
	ADD A, R1 
	MOV SBUF, A
	CALL TACHSO
	JMP MAIN
	SUB:
	CJNE R3, #'-', MULTI
	SUBB A, R1 
	MOV SBUF, A
	CALL TACHSO
	JMP MAIN
	MULTI:
	CJNE R3, #'*', DIVI
	MOV B, R1
	MUL AB
	MOV SBUF, A
	CALL TACHSO
	JMP MAIN
	DIVI:
	CJNE R3, #'/', OUT
	CJNE R1, #0, DIVI1
	MOV R2, #'E'
	CALL HIENTHI
	JMP MAIN
	DIVI1:
	MOV B, R1
	DIV AB
	MOV SBUF, A
	CALL TACHSO
	JMP MAIN
	OUT:
	MOV SBUF, A
	CALL TACHSO
	JMP MAIN
RESET1:
	MOV R0, #-1
	MOV R1, #-1
	MOV R2, #254
	CALL HIENTHI
	MOV R2, #1
	CALL HIENTHI
	JMP MAIN
DELAY:
	MOV R5, #2
DELAY1:
	MOV R6, #255
DELAY2:
	MOV R7, #255
	DJNZ R7, $
	DJNZ R6, DELAY2
	DJNZ R5, DELAY1
	RET
END